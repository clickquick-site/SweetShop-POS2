/* ================================================
   TRANSLATIONS â€” Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ±Ø¬Ù…Ø©
================================================ */
const TRANSLATIONS = {
  ar: {
    login_title:"ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„", login_btn:"Ø¯Ø®ÙˆÙ„", logout:"Ø®Ø±ÙˆØ¬",
    pin_placeholder:"Ø±Ù…Ø² PIN",
    menu_sale:"ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø¨ÙŠØ¹", menu_stock:"ğŸ“¦ Ø§Ù„Ù…Ø®Ø²ÙˆÙ†",
    menu_customers:"ğŸ‘¥ Ø§Ù„Ø²Ø¨Ø§Ø¦Ù†", menu_users:"ğŸ‘¤ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†",
    menu_reports:"ğŸ“Š Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø¹Ù…Ø§Ù„", menu_settings:"âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª",
    back:"Ø§Ù„Ø±Ø¬ÙˆØ¹",
    sale_title:"ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø¨ÙŠØ¹",
    search_placeholder:"Ø§Ø³Ù… Ø£Ùˆ Ø¨Ø§Ø±ÙƒÙˆØ¯",
    add_btn:"â• Ø¥Ø¶Ø§ÙØ©",
    col_item:"Ø³Ù„Ø¹Ø©", col_qty:"ÙƒÙ…ÙŠØ©", col_price:"Ø³Ø¹Ø±",
    col_total:"Ù…Ø¬Ù…ÙˆØ¹", col_options:"Ø®ÙŠØ§Ø±Ø§Øª",
    col_name:"Ø§Ù„Ø§Ø³Ù…", col_role:"Ø§Ù„Ø¯ÙˆØ±",
    paid_placeholder:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¯ÙÙˆØ¹",
    pay_btn:"âœ… ØªØ³Ø¯ÙŠØ¯", partial_btn:"ğŸ’° Ø¬Ø²Ø¦ÙŠ", debt_btn:"ğŸ“‹ Ø¯ÙŠÙ†",
    tab_families:"Ø§Ù„Ø¹Ø§Ø¦Ù„Ø§Øª", tab_brands:"Ø§Ù„Ù…Ø§Ø±ÙƒØ§Øª", tab_all_stock:"ÙƒÙ„ Ø§Ù„Ø³Ù„Ø¹",
    families_title:"ğŸ“ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø§Øª â€” Ù†ÙˆØ¹ Ø§Ù„Ù…Ù†ØªØ¬",
    brands_title:"ğŸ·ï¸ Ø§Ù„Ù…Ø§Ø±ÙƒØ§Øª â€” Ø¹Ø§Ø¦Ù„Ø© Ø§Ù„Ù…Ù†ØªØ¬",
    add_product_title:"â• Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯",
    all_products:"ğŸ“‹ ÙƒÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª",
    family_ph:"Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©...",
    brand_ph:"Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø±ÙƒØ©...",
    add_family:"â• Ø¥Ø¶Ø§ÙØ©", add_brand:"â• Ø¥Ø¶Ø§ÙØ©",
    family_label:"Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©", brand_label:"Ø§Ù„Ù…Ø§Ø±ÙƒØ©",
    size_label:"Ø§Ù„Ø­Ø¬Ù… / Ø§Ù„Ù…Ù‚Ø§Ø³", barcode_label:"Ø¨Ø§Ø±ÙƒÙˆØ¯",
    price_label:"Ø³Ø¹Ø± Ø§Ù„Ø¨ÙŠØ¹", cost_label:"Ø³Ø¹Ø± Ø§Ù„Ø´Ø±Ø§Ø¡",
    qty_label:"Ø§Ù„ÙƒÙ…ÙŠØ©", exp_label:"ØªØ§Ø±ÙŠØ® Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©",
    save_item:"ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ù…Ù†ØªØ¬",
    stock_search_ph:"ğŸ” Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…Ø®Ø²ÙˆÙ†...",
    edit_btn:"ØªØ¹Ø¯ÙŠÙ„", del_btn:"Ù…Ø³Ø­",
    tab_day:"Ø§Ù„ÙŠÙˆÙ…", tab_week:"Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹", tab_month:"Ø§Ù„Ø´Ù‡Ø±",
    tab_year:"Ø§Ù„Ø³Ù†Ø©", tab_all:"Ø§Ù„ÙƒÙ„",
    r_sales:"Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø¨ÙŠØ¹", r_revenue:"Ø§Ù„Ù…Ø¯Ø§Ø®ÙŠÙ„",
    r_cost:"ØªÙƒÙ„ÙØ© Ø§Ù„Ø´Ø±Ø§Ø¡", r_profit:"ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­",
    debts_title:"ğŸ“‹ ØªØªØ¨Ø¹ Ø§Ù„Ø¯ÙŠÙˆÙ†",
    total_debts:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¯ÙŠÙˆÙ†", debtors_count:"Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¯ÙŠÙ†ÙŠÙ†",
    sales_log:"ğŸ“œ Ø³Ø¬Ù„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª",
    settle_btn:"ØªØ³ÙˆÙŠØ©",
    no_debts:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¯ÙŠÙˆÙ† ğŸ‰", no_sales:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù…Ù„ÙŠØ§Øª",
    stab_app:"ğŸ–¥ï¸ Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬", stab_store:"ğŸª Ø§Ù„Ù…ØªØ¬Ø±",
    stab_print:"ğŸ–¨ï¸ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©", stab_system:"ğŸ”§ Ø§Ù„Ù†Ø¸Ø§Ù…",
    date_format:"ØµÙŠØºØ© Ø§Ù„ØªØ§Ø±ÙŠØ®", time_format:"ØµÙŠØºØ© Ø§Ù„ÙˆÙ‚Øª",
    currency_label:"Ø±Ù…Ø² Ø§Ù„Ø¹Ù…Ù„Ø©", lang_label:"Ù„ØºØ© Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬",
    save_app:"ğŸ’¾ Ø­ÙØ¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬",
    logo_label:"Ø´Ø¹Ø§Ø± Ø§Ù„Ù…ØªØ¬Ø±",
    upload_logo:"ğŸ“· ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø´Ø¹Ø§Ø±", remove_logo:"ğŸ—‘ï¸ Ø­Ø°Ù",
    shop_name:"Ø§Ø³Ù… Ø§Ù„Ù…ØªØ¬Ø±", phone_label:"Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ",
    address_label:"Ø§Ù„Ø¹Ù†ÙˆØ§Ù†", welcome_label:"Ø±Ø³Ø§Ù„Ø© ØªØ±Ø­ÙŠØ¨ Ù„Ù„ÙØ§ØªÙˆØ±Ø©",
    save_store:"ğŸ’¾ Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØªØ¬Ø±",
    invoice_num:"Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø­Ø§Ù„ÙŠ (Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªØ¹Ø¯ÙŠÙ„)",
    printer_label:"Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø·Ø§Ø¨Ø¹Ø©", paper_size:"Ù…Ù‚Ø§Ø³ Ø§Ù„ÙˆØ±Ù‚",
    copies_label:"Ø¹Ø¯Ø¯ Ø§Ù„Ù†Ø³Ø®",
    print_logo:"Ø·Ø¨Ø§Ø¹Ø© Ø´Ø¹Ø§Ø± Ø§Ù„Ù…ØªØ¬Ø±", print_name:"Ø·Ø¨Ø§Ø¹Ø© Ø§Ø³Ù… Ø§Ù„Ù…ØªØ¬Ø±",
    print_phone:"Ø·Ø¨Ø§Ø¹Ø© Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ", print_welcome:"Ø·Ø¨Ø§Ø¹Ø© Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨",
    print_barcode:"Ø·Ø¨Ø§Ø¹Ø© Ø¨Ø§Ø±ÙƒÙˆØ¯ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª",
    print_cust_barcode:"Ø·Ø¨Ø§Ø¹Ø© Ø¨Ø§Ø±ÙƒÙˆØ¯ Ø¹Ù„Ù‰ ÙˆØ±Ù‚Ø© Ø§Ù„Ø²Ø¨ÙˆÙ†",
    save_print:"ğŸ’¾ Ø­ÙØ¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©",
    auto_backup_title:"ğŸ’¾ Ø³Ø¬Ù„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª ÙˆØ§Ù„Ù†Ø³Ø® Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ",
    auto_backup_desc:"ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù†Ø³Ø® Ø§Ù„ÙŠÙˆÙ…ÙŠ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ÙˆØ³Ø¬Ù„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª.",
    auto_backup_toggle:"ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù†Ø³Ø® Ø§Ù„ÙŠÙˆÙ…ÙŠ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ",
    manual_backup:"ğŸ“¥ Ù†Ø³Ø® Ø§Ø­ØªÙŠØ§Ø·ÙŠ Ø§Ù„Ø¢Ù†",
    reset_btn:"ğŸ”´ Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· Ø§Ù„Ù†Ø¸Ø§Ù…",
    reset_warning:"âš ï¸ ØªØ­Ø°ÙŠØ±: Ù‡Ø°Ø§ Ø§Ù„Ø¬Ø²Ø¡ Ø³ÙŠÙ‚ÙˆÙ… Ø¨Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Ø§Ù„Ù…Ù†ØªØ¬Ø§ØªØŒ Ø§Ù„ÙÙˆØ§ØªÙŠØ±ØŒ Ø§Ù„Ø²Ø¨Ø§Ø¦Ù†ØŒ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±) ÙˆØ¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ù„Ø­Ø§Ù„ØªÙ‡ Ø§Ù„Ø£ØµÙ„ÙŠØ© Ù…Ù† Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©.",
    customer_ph:"Ø§Ø³Ù… Ø§Ù„Ø²Ø¨ÙˆÙ†",
    username_ph:"Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…",
    role_seller:"Ø¨Ø§Ø¦Ø¹", role_manager:"Ù…Ø¯ÙŠØ±",
    add_user:"â• Ø¥Ø¶Ø§ÙØ©",
    lang_preview:"Ø³ÙŠØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù„ØºØ© Ø¨Ø¹Ø¯ Ø§Ù„Ø­ÙØ¸.",
    msg_select_user:"Ø§Ø®ØªØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£ÙˆÙ„Ø§Ù‹",
    msg_wrong_pin:"Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ Ø§Ù„Ø±Ù…Ø² Ø®Ø§Ø·Ø¦",
    msg_saved:"âœ… ØªÙ… Ø§Ù„Ø­ÙØ¸ Ø¨Ù†Ø¬Ø§Ø­!",
    msg_family_exists:"Ù‡Ø°Ù‡ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© Ù…ÙˆØ¬ÙˆØ¯Ø© Ù…Ø³Ø¨Ù‚Ø§Ù‹",
    msg_brand_exists:"Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø§Ø±ÙƒØ© Ù…ÙˆØ¬ÙˆØ¯Ø© Ù…Ø³Ø¨Ù‚Ø§Ù‹",
    msg_select_family:"Ø§Ø®ØªØ± Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© Ø£ÙˆÙ„Ø§Ù‹",
    msg_barcode_exists:"Ù‡Ø°Ø§ Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯ Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹",
    msg_item_updated:"Ø§Ù„Ù…Ù†ØªØ¬ Ù…ÙˆØ¬ÙˆØ¯ â€” ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙƒÙ…ÙŠØ©!",
    msg_item_saved:"âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­!",
    msg_fill_all:"Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­!",
    msg_no_cart:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ø§Ù„Ø¹Ø±Ø¨Ø©!",
    msg_low_balance:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¯ÙÙˆØ¹ Ø£Ù‚Ù„ Ù…Ù† Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ",
    msg_sold:"âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ¹ Ø¨Ù†Ø¬Ø§Ø­!",
    msg_change:"âœ… ØªÙ… Ø§Ù„Ø¨ÙŠØ¹!\nØ§Ù„Ø¨Ø§Ù‚ÙŠ Ù„Ù„Ø²Ø¨ÙˆÙ†: ",
    msg_partial_ok:"âœ… Ø¯ÙØ¹ Ø¬Ø²Ø¦ÙŠ!\nÙ…Ø¯ÙÙˆØ¹: ",
    msg_partial_rem:"\nÙ…ØªØ¨Ù‚ÙŠ: ",
    msg_need_amount:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¯ÙÙˆØ¹ Ø¬Ø²Ø¦ÙŠØ§Ù‹",
    msg_covers_all:"Ø§Ù„Ù…Ø¨Ù„Øº ÙŠØºØ·ÙŠ Ø§Ù„ÙƒÙ„ØŒ Ø§Ø³ØªØ®Ø¯Ù… 'ØªØ³Ø¯ÙŠØ¯'",
    msg_select_customer:"Ø§Ø®ØªØ± Ø²Ø¨ÙˆÙ†Ø§Ù‹ Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯ÙŠÙ† Ø¹Ù„ÙŠÙ‡",
    msg_debt_ok:"âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯ÙŠÙ† Ø¹Ù„Ù‰ ",
    msg_debt_amount:"\nØ§Ù„Ù…Ø¨Ù„Øº: ",
    msg_out_of_stock:"Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ Ù†ÙØ° Ù…Ù† Ø§Ù„Ù…Ø®Ø²ÙˆÙ†!",
    msg_not_enough:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø®Ø²ÙˆÙ† ÙƒØ§ÙÙ!",
    msg_not_found:"Ø§Ù„Ù…Ù†ØªØ¬ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø§Ù„Ù…Ø®Ø²ÙˆÙ†",
    msg_enter_search:"Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ø³Ù„Ø¹Ø© Ø£Ùˆ Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯",
    msg_customer_exists:"Ø§Ù„Ø²Ø¨ÙˆÙ† Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹",
    msg_enter_customer:"Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ø²Ø¨ÙˆÙ†",
    msg_user_exists:"Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ù‹Ø§",
    msg_pin_format:"Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… ØµØ­ÙŠØ­ ÙˆPIN Ù…Ù† 4 Ø£Ø±Ù‚Ø§Ù…",
    msg_pin_4:"PIN ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 4 Ø£Ø±Ù‚Ø§Ù…",
    msg_cant_delete:"Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…",
    msg_confirm_delete_user:"Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ØŸ",
    msg_confirm_delete:"Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬ØŸ",
    msg_confirm_delete_customer:"Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø²Ø¨ÙˆÙ†ØŸ",
    msg_confirm_delete_family:"Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©ØŸ Ø³ÙŠØªÙ… Ø­Ø°Ù Ù…Ø§Ø±ÙƒØ§ØªÙ‡Ø§ Ø£ÙŠØ¶Ø§Ù‹.",
    msg_confirm_delete_brand:"Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø§Ø±ÙƒØ©ØŸ",
    msg_backup_done:"âœ… ØªÙ… ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©!",
    msg_backup_auto_on:"âœ… ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù†Ø³Ø® Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø§Ù„ÙŠÙˆÙ…ÙŠ.",
    msg_backup_auto_off:"ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù†Ø³Ø® Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ.",
    msg_reset_confirm:"Ø§ÙƒØªØ¨ 'Ù†Ø¹Ù…' Ù„Ù„ØªØ£ÙƒÙŠØ¯:",
    msg_reset_done:"âœ… ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· Ø§Ù„Ù†Ø¸Ø§Ù….",
    msg_reset_cancel:"ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©.",
    settle_prompt:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¯ÙÙˆØ¹:",
    settle_ok:"âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø¯ÙØ¹ ",
    settle_from:" Ù…Ù† ",
    no_stock:"Ø§Ù„Ù…Ø®Ø²ÙˆÙ† ÙØ§Ø±Øº",
    no_families:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ø§Ø¦Ù„Ø§Øª Ø¨Ø¹Ø¯",
    no_brands:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø§Ø±ÙƒØ§Øª Ø¨Ø¹Ø¯",
    no_customers:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø²Ø¨Ø§Ø¦Ù† Ø¨Ø¹Ø¯",
    msg_clear_month_confirm:"Ù‡Ù„ ØªØ±ÙŠØ¯ Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª Ù„Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±ØŸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹.",
    msg_clear_year_confirm:"Ù‡Ù„ ØªØ±ÙŠØ¯ Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª Ù„Ù‡Ø°Ù‡ Ø§Ù„Ø³Ù†Ø©ØŸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹.",
    msg_clear_done:"âœ… ØªÙ… Ù…Ø³Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­.",
    msg_clear_cancel:"ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©.",
  },
};

/* ================================================
   APP STATE â€” Ø­Ø§Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
================================================ */
let appData = {
  users: [],
  families: [],
  brands: [],
  products: [],
  customers: [],
  sales: [],
  debts: [],
  config: {
    shopName: 'Ù…ØªØ¬Ø±ÙŠ',
    shopPhone: '',
    shopAddress: '',
    currency: 'Ø¯Ø¬',
    lang: 'ar',
    dateFormat: 'DD/MM/YYYY',
    timeFormat: '24h',
    nextInvoiceNum: 1,
    printSettings: {
      paperSize: '58mm',
      copies: 1,
      printLogo: false,
      printShopName: true,
      printPhone: true,
      printWelcome: true,
      printBarcode: false,
      printCustBarcode: true,
    },
    autoBackup: false,
  }
};

let currentUser = null;
let currentCart = [];
let searchQuery = '';

/* ================================================
   INITIALIZATION â€” Ø§Ù„ØªÙ‡ÙŠØ¦Ø©
================================================ */
function initApp() {
  loadData();
  setupEventListeners();
  updateClock();
  setInterval(updateClock, 1000);
  checkAutoBackup();
}

function setupEventListeners() {
  document.getElementById('userSelect').addEventListener('change', () => {
    document.getElementById('pin').value = '';
  });
  document.getElementById('pin').addEventListener('keypress', (e) => {
    if (e.key === 'Enter') login();
  });
  document.getElementById('search').addEventListener('keypress', (e) => {
    if (e.key === 'Enter') addItem();
  });
}

/* ================================================
   LOGIN SYSTEM â€” Ù†Ø¸Ø§Ù… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
================================================ */
function login() {
  const userIdx = document.getElementById('userSelect').selectedIndex;
  const pin = document.getElementById('pin').value;
  const msg = document.getElementById('loginMsg');

  if (!appData.users.length) {
    initializeDefaultUser();
  }

  if (userIdx < 0) {
    msg.textContent = t('msg_select_user');
    return;
  }

  const user = appData.users[userIdx];
  if (user.pin !== pin) {
    msg.textContent = t('msg_wrong_pin');
    return;
  }

  currentUser = user;
  msg.textContent = '';
  document.getElementById('loginScreen').style.display = 'none';
  document.getElementById('mainApp').style.display = 'flex';
  
  loadUserSelect();
  show('sale');
}

function logout() {
  currentUser = null;
  currentCart = [];
  document.getElementById('loginScreen').style.display = 'flex';
  document.getElementById('mainApp').style.display = 'none';
  document.getElementById('pin').value = '';
  loadUserSelect();
}

function initializeDefaultUser() {
  appData.users.push({ name: 'Ù…Ø¯ÙŠØ±', pin: '0000', role: 'manager' });
  saveData();
}

function loadUserSelect() {
  const select = document.getElementById('userSelect');
  select.innerHTML = '';
  appData.users.forEach((user, idx) => {
    const opt = document.createElement('option');
    opt.value = idx;
    opt.textContent = user.name;
    select.appendChild(opt);
  });
}

/* ================================================
   SEARCH & SUGGESTIONS â€” Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª
   âœ… ØªØ­Ø³ÙŠÙ†: Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø´Ø§Ù…Ù„ Ø¹Ù† Ø§Ù„Ù…Ø§Ø±ÙƒØ§Øª ÙˆØ§Ù„Ø¹Ø§Ø¦Ù„Ø§Øª
================================================ */
function searchSuggestions() {
  const search = document.getElementById('search').value.trim();
  const container = document.getElementById('searchSuggestions');

  if (!search) {
    container.classList.add('hidden');
    return;
  }

  const query = search.toLowerCase();
  const matches = [];

  // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
  appData.products.forEach(product => {
    const productName = product.name.toLowerCase();
    const brandName = product.brand.toLowerCase();
    const familyName = product.family.toLowerCase();
    const barcode = product.barcode.toLowerCase();

    // Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø´Ø§Ù…Ù„: ÙŠØ¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù†Øµ ÙÙŠ Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„Ù…Ø§Ø±ÙƒØ© Ø£Ùˆ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© Ø£Ùˆ Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯
    if (productName.includes(query) || brandName.includes(query) || 
        familyName.includes(query) || barcode.includes(query)) {
      if (!matches.find(m => m.id === product.id)) {
        matches.push(product);
      }
    }
  });

  // Ø¹Ø±Ø¶ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª
  if (matches.length === 0) {
    container.innerHTML = '<div style="padding:8px;color:var(--text3)">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬</div>';
    container.classList.remove('hidden');
  } else {
    container.innerHTML = matches.map(p => `
      <div class="suggestion-item" onclick="selectSuggestion('${p.id}')">
        <div style="font-weight:700;color:var(--text)">${p.name}</div>
        <div style="font-size:12px;color:var(--text3)">
          Ø§Ù„Ù…Ø§Ø±ÙƒØ©: ${p.brand} | Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©: ${p.family} | Ø§Ù„Ù…Ø®Ø²ÙˆÙ†: ${p.qty}
        </div>
      </div>
    `).join('');
    container.classList.remove('hidden');
  }
}

function selectSuggestion(productId) {
  const product = appData.products.find(p => p.id === productId);
  if (product) {
    document.getElementById('search').value = product.name;
    document.getElementById('searchSuggestions').classList.add('hidden');
    addItem();
  }
}

/* ================================================
   SALE INTERFACE â€” ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø¨ÙŠØ¹
================================================ */
function addItem() {
  const searchVal = document.getElementById('search').value.trim();
  const qty = parseInt(document.getElementById('searchQty').value) || 1;

  if (!searchVal) {
    showToast(t('msg_enter_search'));
    return;
  }

  const query = searchVal.toLowerCase();
  let product = null;

  // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù€: Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯ Ø£Ùˆ Ø§Ù„Ù…Ø§Ø±ÙƒØ© Ø£Ùˆ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©
  product = appData.products.find(p => 
    p.name.toLowerCase() === query || 
    p.barcode.toLowerCase() === query ||
    p.brand.toLowerCase() === query ||
    p.family.toLowerCase() === query
  );

  // Ø¥Ø°Ø§ Ù„Ù… ÙŠØ¬Ø¯ ØªØ·Ø§Ø¨Ù‚ Ø¯Ù‚ÙŠÙ‚ØŒ Ø§Ø¨Ø­Ø« Ø¹Ù† ØªØ·Ø§Ø¨Ù‚ Ø¬Ø²Ø¦ÙŠ
  if (!product) {
    product = appData.products.find(p =>
      p.name.toLowerCase().includes(query) ||
      p.barcode.toLowerCase().includes(query) ||
      p.brand.toLowerCase().includes(query) ||
      p.family.toLowerCase().includes(query)
    );
  }

  if (!product) {
    showToast(t('msg_not_found'));
    return;
  }

  if (product.qty < qty) {
    showToast(t('msg_not_enough'));
    return;
  }

  const existingItem = currentCart.find(item => item.id === product.id);
  if (existingItem) {
    existingItem.qty += qty;
  } else {
    currentCart.push({
      id: product.id,
      name: product.name,
      price: product.price,
      cost: product.cost,
      qty: qty,
      brand: product.brand,
      family: product.family,
    });
  }

  document.getElementById('search').value = '';
  document.getElementById('searchQty').value = '1';
  document.getElementById('searchSuggestions').classList.add('hidden');
  updateCart();
}

function updateCart() {
  const tbody = document.getElementById('cart');
  tbody.innerHTML = '';

  currentCart.forEach((item, idx) => {
    const row = document.createElement('tr');
    const total = (item.price * item.qty).toFixed(2);
    row.innerHTML = `
      <td>${item.name} <span style="color:var(--text3);font-size:12px">(${item.brand})</span></td>
      <td><input type="number" value="${item.qty}" min="1" onchange="updateItemQty(${idx}, this.value)"></td>
      <td>${item.price}</td>
      <td>${total}</td>
      <td><button onclick="removeItem(${idx})" style="background:#fee2e2;color:#ef4444;padding:4px 8px;border:none;border-radius:4px;cursor:pointer">âŒ</button></td>
    `;
    tbody.appendChild(row);
  });

  const clearBtn = document.getElementById('clearCartBtn');
  if (currentCart.length > 0) {
    clearBtn.style.display = 'inline-block';
  } else {
    clearBtn.style.display = 'none';
  }

  updateTotal();
}

function updateItemQty(idx, newQty) {
  const qty = parseInt(newQty);
  if (qty > 0) {
    currentCart[idx].qty = qty;
  }
  updateCart();
}

function removeItem(idx) {
  currentCart.splice(idx, 1);
  updateCart();
}

function clearCart() {
  if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ ØªÙØ±ÙŠØº Ø§Ù„Ø³Ù„Ø©ØŸ')) {
    currentCart = [];
    updateCart();
  }
}

function updateTotal() {
  let subtotal = 0;
  currentCart.forEach(item => {
    subtotal += item.price * item.qty;
  });

  const discountVal = parseFloat(document.getElementById('discountVal').value) || 0;
  const discountType = document.getElementById('discountType').value;
  
  let discount = 0;
  if (discountType === 'fixed') {
    discount = discountVal;
  } else {
    discount = (subtotal * discountVal) / 100;
  }

  const total = Math.max(0, subtotal - discount);
  document.getElementById('total').textContent = total.toFixed(2);
  document.getElementById('afterDiscount').textContent = total.toFixed(2) + ' ' + appData.config.currency;
}

function processSale(paymentType) {
  if (currentCart.length === 0) {
    showToast(t('msg_no_cart'));
    return;
  }

  const total = parseFloat(document.getElementById('total').textContent);

  if (paymentType === 'full') {
    const paid = parseFloat(document.getElementById('paid').value);
    if (isNaN(paid) || paid < total) {
      showToast(t('msg_low_balance'));
      return;
    }
    completeSale(total, paid, 'full');
  } else if (paymentType === 'partial') {
    const paid = parseFloat(document.getElementById('paid').value);
    if (isNaN(paid) || paid <= 0) {
      showToast(t('msg_need_amount'));
      return;
    }
    if (paid >= total) {
      showToast(t('msg_covers_all'));
      return;
    }
    completeSale(total, paid, 'partial');
  } else if (paymentType === 'debt') {
    const customerIdx = document.getElementById('customerSelect').selectedIndex;
    if (customerIdx < 0) {
      showToast(t('msg_select_customer'));
      return;
    }
    const customer = appData.customers[customerIdx];
    completeSale(total, 0, 'debt', customer);
  }
}

function completeSale(total, paid, type, customer = null) {
  const sale = {
    id: Date.now(),
    date: new Date(),
    items: JSON.parse(JSON.stringify(currentCart)),
    total: total,
    paid: paid,
    type: type,
    customer: customer ? customer.name : null,
    user: currentUser.name,
  };

  currentCart.forEach(item => {
    const product = appData.products.find(p => p.id === item.id);
    if (product) {
      product.qty -= item.qty;
    }
  });

  appData.sales.push(sale);

  if (type === 'debt' && customer) {
    const debt = appData.debts.find(d => d.customer === customer.name);
    if (debt) {
      debt.amount += total;
    } else {
      appData.debts.push({ customer: customer.name, amount: total, date: new Date() });
    }
  }

  saveData();
  currentCart = [];
  document.getElementById('search').value = '';
  document.getElementById('paid').value = '';
  document.getElementById('discountVal').value = '0';
  updateCart();

  if (type === 'full') {
    const change = paid - total;
    showToast(t('msg_change') + change.toFixed(2) + ' ' + appData.config.currency);
    printInvoice(sale);
  } else if (type === 'partial') {
    const remaining = total - paid;
    showToast(t('msg_partial_ok') + paid.toFixed(2) + t('msg_partial_rem') + remaining.toFixed(2));
    printInvoice(sale);
  } else {
    showToast(t('msg_debt_ok') + customer.name + t('msg_debt_amount') + total.toFixed(2));
    printInvoice(sale);
  }
}

/* ================================================
   STOCK MANAGEMENT â€” Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø²ÙˆÙ†
   âœ… ØªØ­Ø³ÙŠÙ†: Ø®Ø§Ù†Ø© Ø§Ù„Ù…Ø§Ø±ÙƒØ© Ù…ÙØªÙˆØ­Ø© Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„ÙŠØ¯ÙˆÙŠ
================================================ */
function showStockTab(tabName) {
  document.querySelectorAll('.stock-tab-content').forEach(el => {
    el.classList.add('hidden');
  });
  document.getElementById('stockTab-' + tabName).classList.remove('hidden');

  if (tabName === 'families') {
    loadFamilies();
  } else if (tabName === 'brands') {
    loadBrands();
  } else if (tabName === 'all') {
    loadAllProducts();
  }
}

function loadFamilies() {
  const container = document.getElementById('familiesList');
  if (appData.families.length === 0) {
    container.innerHTML = '<p>' + t('no_families') + '</p>';
    return;
  }

  container.innerHTML = appData.families.map((fam, idx) => `
    <div class="family-card">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div>
          <div style="font-weight:700;font-size:16px">${fam.name}</div>
          <div style="font-size:13px;color:var(--text3)">Ø§Ù„Ù…Ø§Ø±ÙƒØ§Øª: ${(appData.brands.filter(b => b.family === fam.name).length)}</div>
        </div>
        <button onclick="deleteFamily(${idx})" style="background:#fee2e2;color:#ef4444;padding:4px 8px;border:none;border-radius:4px;cursor:pointer">ğŸ—‘ï¸</button>
      </div>
    </div>
  `).join('');
}

function addFamily() {
  const name = prompt(t('family_ph'));
  if (!name) return;

  if (appData.families.find(f => f.name === name)) {
    showToast(t('msg_family_exists'));
    return;
  }

  appData.families.push({ name: name });
  saveData();
  loadFamilies();
  showToast(t('msg_saved'));
}

function deleteFamily(idx) {
  if (!confirm(t('msg_confirm_delete_family'))) return;
  
  const familyName = appData.families[idx].name;
  appData.brands = appData.brands.filter(b => b.family !== familyName);
  appData.products = appData.products.filter(p => p.family !== familyName);
  appData.families.splice(idx, 1);
  saveData();
  loadFamilies();
}

function loadBrands() {
  const familySelect = document.getElementById('brandFamilySelect');
  const container = document.getElementById('brandsList');

  familySelect.innerHTML = '<option value="">-- Ø§Ø®ØªØ± Ø¹Ø§Ø¦Ù„Ø© --</option>' + 
    appData.families.map((fam, idx) => `
      <option value="${idx}">${fam.name}</option>
    `).join('');

  const selectedIdx = familySelect.value;
  let brands = appData.brands;

  if (selectedIdx !== '') {
    const selectedFamily = appData.families[selectedIdx].name;
    brands = appData.brands.filter(b => b.family === selectedFamily);
  }

  if (brands.length === 0) {
    container.innerHTML = '<p>' + t('no_brands') + '</p>';
    return;
  }

  container.innerHTML = brands.map((brand, idx) => `
    <div class="brand-card">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div>
          <div style="font-weight:700;font-size:16px">${brand.name}</div>
          <div style="font-size:13px;color:var(--text3)">Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©: ${brand.family}</div>
          <div style="font-size:13px;color:var(--text3)">Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª: ${appData.products.filter(p => p.brand === brand.name).length}</div>
        </div>
        <button onclick="deleteBrand('${brand.name}')" style="background:#fee2e2;color:#ef4444;padding:4px 8px;border:none;border-radius:4px;cursor:pointer">ğŸ—‘ï¸</button>
      </div>
    </div>
  `).join('');
}

function addBrand() {
  const familySelect = document.getElementById('brandFamilySelect');
  const selectedIdx = familySelect.value;

  if (selectedIdx === '') {
    showToast(t('msg_select_family'));
    return;
  }

  const family = appData.families[selectedIdx].name;
  const name = prompt(t('brand_ph'));
  if (!name) return;

  if (appData.brands.find(b => b.name === name && b.family === family)) {
    showToast(t('msg_brand_exists'));
    return;
  }

  appData.brands.push({ name: name, family: family });
  saveData();
  loadBrands();
  showToast(t('msg_saved'));
}

function deleteBrand(brandName) {
  if (!confirm(t('msg_confirm_delete_brand'))) return;
  
  appData.products = appData.products.filter(p => p.brand !== brandName);
  appData.brands = appData.brands.filter(b => b.name !== brandName);
  saveData();
  loadBrands();
}

function loadAllProducts() {
  const searchVal = document.getElementById('stockSearch').value.toLowerCase();
  let products = appData.products;

  // Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø´Ø§Ù…Ù„ Ø¹Ù† Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
  if (searchVal) {
    products = products.filter(p =>
      p.name.toLowerCase().includes(searchVal) ||
      p.barcode.toLowerCase().includes(searchVal) ||
      p.brand.toLowerCase().includes(searchVal) ||
      p.family.toLowerCase().includes(searchVal)
    );
  }

  const container = document.getElementById('allProductsList');
  if (products.length === 0) {
    container.innerHTML = '<p>' + (searchVal ? 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬' : t('no_stock')) + '</p>';
    return;
  }

  container.innerHTML = products.map(p => `
    <div class="product-card">
      <div style="display:flex;justify-content:space-between;align-items:start">
        <div>
          <div style="font-weight:700;font-size:15px">${p.name}</div>
          <div style="font-size:12px;color:var(--text3);margin-top:4px">
            <div>Ø§Ù„Ù…Ø§Ø±ÙƒØ©: ${p.brand}</div>
            <div>Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©: ${p.family}</div>
            <div>Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯: ${p.barcode}</div>
            <div>Ø§Ù„Ù…Ø®Ø²ÙˆÙ†: <span style="color:${p.qty < 5 ? '#ef4444' : '#10b981'};font-weight:700">${p.qty}</span></div>
            <div>Ø§Ù„Ø³Ø¹Ø±: ${p.price} ${appData.config.currency}</div>
          </div>
        </div>
        <div style="display:flex;flex-direction:column;gap:4px">
          <button onclick="editProduct('${p.id}')" style="background:var(--primary);color:white;padding:4px 8px;border:none;border-radius:4px;cursor:pointer;font-size:12px">ØªØ¹Ø¯ÙŠÙ„</button>
          <button onclick="deleteProduct('${p.id}')" style="background:#fee2e2;color:#ef4444;padding:4px 8px;border:none;border-radius:4px;cursor:pointer;font-size:12px">Ø­Ø°Ù</button>
        </div>
      </div>
    </div>
  `).join('');
}

function showAddProductModal() {
  document.getElementById('addProductModal').style.display = 'flex';
  loadAddProductForm();
}

function loadAddProductForm() {
  const familySelect = document.getElementById('pFamily');
  familySelect.innerHTML = '<option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© --</option>' + 
    appData.families.map(fam => `<option value="${fam.name}">${fam.name}</option>`).join('');

  document.getElementById('pName').value = '';
  document.getElementById('pBrand').value = '';
  document.getElementById('pSize').value = '';
  document.getElementById('pBarcode').value = '';
  document.getElementById('pPrice').value = '';
  document.getElementById('pCost').value = '';
  document.getElementById('pQty').value = '';
  document.getElementById('pExp').value = '';
  document.getElementById('productEditId').value = '';
}

function saveProduct() {
  const family = document.getElementById('pFamily').value;
  const brand = document.getElementById('pBrand').value.trim();
  const name = document.getElementById('pName').value.trim();
  const size = document.getElementById('pSize').value.trim();
  const barcode = document.getElementById('pBarcode').value.trim();
  const price = parseFloat(document.getElementById('pPrice').value);
  const cost = parseFloat(document.getElementById('pCost').value);
  const qty = parseInt(document.getElementById('pQty').value);
  const exp = document.getElementById('pExp').value;
  const editId = document.getElementById('productEditId').value;

  if (!family || !brand || !name || !barcode || isNaN(price) || isNaN(qty)) {
    showToast(t('msg_fill_all'));
    return;
  }

  if (!appData.brands.find(b => b.name === brand && b.family === family)) {
    showToast('Ø§Ù„Ù…Ø§Ø±ÙƒØ© ' + brand + ' ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø© ØªØ­Øª Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© ' + family);
    return;
  }

  if (editId) {
    const product = appData.products.find(p => p.id === editId);
    if (product) {
      product.family = family;
      product.brand = brand;
      product.name = name;
      product.size = size;
      product.barcode = barcode;
      product.price = price;
      product.cost = cost;
      product.qty = qty;
      product.exp = exp;
    }
  } else {
    if (appData.products.find(p => p.barcode === barcode)) {
      showToast(t('msg_barcode_exists'));
      return;
    }
    appData.products.push({
      id: 'prod_' + Date.now(),
      family: family,
      brand: brand,
      name: name,
      size: size,
      barcode: barcode,
      price: price,
      cost: cost,
      qty: qty,
      exp: exp,
      created: new Date(),
    });
  }

  saveData();
  document.getElementById('addProductModal').style.display = 'none';
  loadAllProducts();
  showToast(t('msg_item_saved'));
}

function editProduct(productId) {
  const product = appData.products.find(p => p.id === productId);
  if (!product) return;

  document.getElementById('pName').value = product.name;
  document.getElementById('pBrand').value = product.brand;
  document.getElementById('pSize').value = product.size || '';
  document.getElementById('pBarcode').value = product.barcode;
  document.getElementById('pPrice').value = product.price;
  document.getElementById('pCost').value = product.cost || '';
  document.getElementById('pQty').value = product.qty;
  document.getElementById('pExp').value = product.exp || '';
  document.getElementById('pFamily').value = product.family;
  document.getElementById('productEditId').value = productId;

  const modal = document.getElementById('addProductModal');
  modal.style.display = 'flex';
  modal.scrollIntoView({ behavior: 'smooth' });
}

function deleteProduct(productId) {
  if (!confirm(t('msg_confirm_delete'))) return;
  
  appData.products = appData.products.filter(p => p.id !== productId);
  saveData();
  loadAllProducts();
}

/* ================================================
   POINTS OF SALE â€” Ù†Ù‚Ø§Ø· Ø§Ù„Ø¨ÙŠØ¹
   âœ… ØªØ­Ø³ÙŠÙ†: Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø´Ø§Ù…Ù„ Ø¹Ù† Ù†Ù‚Ø§Ø· Ø§Ù„Ø¨ÙŠØ¹
================================================ */
function loadSalesPoints() {
  const searchVal = document.getElementById('salePointSearch').value.toLowerCase();
  let sales = appData.sales;

  // Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø´Ø§Ù…Ù„ Ø¹Ù† Ù†Ù‚Ø§Ø· Ø§Ù„Ø¨ÙŠØ¹
  if (searchVal) {
    sales = sales.filter(s => 
      s.customer.toLowerCase().includes(searchVal) ||
      s.user.toLowerCase().includes(searchVal) ||
      s.items.some(i => i.name.toLowerCase().includes(searchVal)) ||
      s.items.some(i => i.brand.toLowerCase().includes(searchVal)) ||
      s.items.some(i => i.family.toLowerCase().includes(searchVal)) ||
      new Date(s.date).toLocaleDateString('ar-DZ').includes(searchVal)
    );
  }

  const container = document.getElementById('salesPointsList');
  if (sales.length === 0) {
    container.innerHTML = '<p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù…Ù„ÙŠØ§Øª Ø¨ÙŠØ¹</p>';
    return;
  }

  container.innerHTML = sales.map(sale => `
    <div class="sale-card">
      <div style="display:flex;justify-content:space-between;align-items:start;margin-bottom:8px">
        <div>
          <div style="font-weight:700">#${sale.id}</div>
          <div style="font-size:12px;color:var(--text3)">${new Date(sale.date).toLocaleString('ar-DZ')}</div>
        </div>
        <div style="text-align:left">
          <div style="font-weight:700;color:var(--primary);font-size:16px">${sale.total.toFixed(2)} ${appData.config.currency}</div>
          <div style="font-size:12px;color:var(--text3)">${sale.type === 'full' ? 'ÙƒØ§Ù…Ù„' : sale.type === 'partial' ? 'Ø¬Ø²Ø¦ÙŠ' : 'Ø¯ÙŠÙ†'}</div>
        </div>
      </div>
      <div style="border-top:1px solid var(--border);padding-top:8px;font-size:12px">
        <div>ğŸ‘¤ ${sale.user} ${sale.customer ? '| ğŸ›ï¸ ' + sale.customer : ''}</div>
        <div style="margin-top:4px;color:var(--text3)">
          ${sale.items.map(i => `${i.name} (${i.brand}) x${i.qty}`).join(' | ')}
        </div>
      </div>
    </div>
  `).join('');
}

/* ================================================
   CUSTOMERS â€” Ø§Ù„Ø²Ø¨Ø§Ø¦Ù†
================================================ */
function loadCustomers() {
  const container = document.getElementById('customersList');
  if (appData.customers.length === 0) {
    container.innerHTML = '<p>' + t('no_customers') + '</p>';
    return;
  }

  container.innerHTML = appData.customers.map((cust, idx) => `
    <div class="customer-card">
      <div style="display:flex;justify-content:space-between;align-items:start">
        <div>
          <div style="font-weight:700;font-size:15px">${cust.name}</div>
          <div style="font-size:12px;color:var(--text3);margin-top:4px">
            <div>Ø§Ù„Ù‡Ø§ØªÙ: ${cust.phone || 'N/A'}</div>
            <div>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: ${cust.address || 'N/A'}</div>
          </div>
        </div>
        <button onclick="deleteCustomer(${idx})" style="background:#fee2e2;color:#ef4444;padding:4px 8px;border:none;border-radius:4px;cursor:pointer">ğŸ—‘ï¸</button>
      </div>
    </div>
  `).join('');
}

function addCustomer() {
  const name = prompt(t('customer_ph'));
  if (!name) return;

  if (appData.customers.find(c => c.name === name)) {
    showToast(t('msg_customer_exists'));
    return;
  }

  appData.customers.push({
    id: 'cust_' + Date.now(),
    name: name,
    phone: '',
    address: '',
  });

  saveData();
  loadCustomers();
  loadCustomerSelect();
  showToast(t('msg_saved'));
}

function deleteCustomer(idx) {
  if (!confirm(t('msg_confirm_delete_customer'))) return;
  
  appData.customers.splice(idx, 1);
  saveData();
  loadCustomers();
  loadCustomerSelect();
}

function loadCustomerSelect() {
  const select = document.getElementById('customerSelect');
  select.innerHTML = '<option value="">-- Ø§Ø®ØªØ± Ø²Ø¨ÙˆÙ† --</option>' +
    appData.customers.map((cust, idx) => `
      <option value="${idx}">${cust.name}</option>
    `).join('');
}

/* ================================================
   USERS & ALERTS â€” Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ† ÙˆØ§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª
================================================ */
function openUsersModal() {
  document.getElementById('usersModal').style.display = 'flex';
  loadUsers();
}

function closeUsersModal() {
  document.getElementById('usersModal').style.display = 'none';
}

function loadUsers() {
  const tbody = document.querySelector('#usersTable tbody');
  tbody.innerHTML = appData.users.map((user, idx) => `
    <tr>
      <td>${user.name}</td>
      <td>${user.pin}</td>
      <td>${user.role === 'manager' ? t('role_manager') : t('role_seller')}</td>
      <td>
        <button onclick="deleteUser(${idx})" style="background:#fee2e2;color:#ef4444;padding:4px 8px;border:none;border-radius:4px;cursor:pointer;font-size:12px">ğŸ—‘ï¸ Ø­Ø°Ù</button>
      </td>
    </tr>
  `).join('');
}

document.addEventListener('DOMContentLoaded', function() {
  const form = document.getElementById('addUserForm');
  if (form) {
    form.addEventListener('submit', (e) => {
      e.preventDefault();
      addUser();
    });
  }
});

function addUser() {
  const name = document.getElementById('newUserName').value.trim();
  const pin = document.getElementById('newUserPin').value.trim();
  const role = document.getElementById('newUserRole').value;

  if (!name || !pin || pin.length !== 4 || isNaN(pin)) {
    showToast(t('msg_pin_format'));
    return;
  }

  if (appData.users.find(u => u.name === name)) {
    showToast(t('msg_user_exists'));
    return;
  }

  appData.users.push({ name: name, pin: pin, role: role });
  saveData();
  loadUsers();
  loadUserSelect();

  document.getElementById('newUserName').value = '';
  document.getElementById('newUserPin').value = '';
  showToast(t('msg_saved'));
}

function deleteUser(idx) {
  if (appData.users.length === 1) {
    showToast(t('msg_cant_delete'));
    return;
  }

  if (!confirm(t('msg_confirm_delete_user'))) return;

  appData.users.splice(idx, 1);
  saveData();
  loadUsers();
  loadUserSelect();
}

/* ================================================
   REPORTS â€” Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±
================================================ */
function loadReports() {
  renderSalesReport('day');
}

function renderSalesReport(period) {
  const now = new Date();
  let startDate = new Date();

  if (period === 'day') {
    startDate.setHours(0, 0, 0, 0);
  } else if (period === 'week') {
    const day = now.getDay();
    startDate.setDate(now.getDate() - (day === 0 ? 6 : day - 1));
    startDate.setHours(0, 0, 0, 0);
  } else if (period === 'month') {
    startDate.setDate(1);
    startDate.setHours(0, 0, 0, 0);
  } else if (period === 'year') {
    startDate.setMonth(0, 1);
    startDate.setHours(0, 0, 0, 0);
  }

  const filtered = appData.sales.filter(s => new Date(s.date) >= startDate && s.type === 'full');

  let sales = 0;
  let revenue = 0;
  let cost = 0;

  filtered.forEach(sale => {
    sales++;
    revenue += sale.total;
    sale.items.forEach(item => {
      cost += item.cost * item.qty;
    });
  });

  const profit = revenue - cost;

  document.getElementById('reportSales').textContent = sales;
  document.getElementById('reportRevenue').textContent = revenue.toFixed(2);
  document.getElementById('reportCost').textContent = cost.toFixed(2);
  document.getElementById('reportProfit').textContent = profit.toFixed(2);
}

/* ================================================
   DEBTS â€” Ø§Ù„Ø¯ÙŠÙˆÙ†
================================================ */
function loadDebts() {
  const container = document.getElementById('debtsList');
  if (appData.debts.length === 0) {
    container.innerHTML = '<p>' + t('no_debts') + '</p>';
    return;
  }

  const totalDebts = appData.debts.reduce((sum, d) => sum + d.amount, 0);
  document.getElementById('totalDebts').textContent = totalDebts.toFixed(2);
  document.getElementById('debtorsCount').textContent = appData.debts.length;

  container.innerHTML = appData.debts.map((debt, idx) => `
    <div class="debt-card">
      <div style="display:flex;justify-content:space-between;align-items:start">
        <div>
          <div style="font-weight:700;font-size:15px">${debt.customer}</div>
          <div style="font-size:12px;color:var(--text3);margin-top:4px">
            <div>Ø§Ù„Ù…Ø¨Ù„Øº: ${debt.amount.toFixed(2)} ${appData.config.currency}</div>
            <div>Ø§Ù„ØªØ§Ø±ÙŠØ®: ${new Date(debt.date).toLocaleDateString('ar-DZ')}</div>
          </div>
        </div>
        <button onclick="settleDebt(${idx})" style="background:var(--success);color:white;padding:4px 8px;border:none;border-radius:4px;cursor:pointer">ØªØ³ÙˆÙŠØ©</button>
      </div>
    </div>
  `).join('');
}

function settleDebt(idx) {
  const debt = appData.debts[idx];
  const paid = parseFloat(prompt(t('settle_prompt')));

  if (isNaN(paid) || paid <= 0) return;

  if (paid >= debt.amount) {
    appData.debts.splice(idx, 1);
    showToast(t('settle_ok') + paid.toFixed(2) + t('settle_from') + debt.customer);
  } else {
    debt.amount -= paid;
    showToast(t('settle_ok') + paid.toFixed(2) + t('settle_from') + debt.customer);
  }

  saveData();
  loadDebts();
}

/* ================================================
   SETTINGS â€” Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
================================================ */
function saveAppSettings() {
  appData.config.shopName = document.getElementById('sShopName').value || 'Ù…ØªØ¬Ø±ÙŠ';
  appData.config.currency = document.getElementById('sCurrency').value || 'Ø¯Ø¬';
  appData.config.lang = document.getElementById('sLang').value || 'ar';
  appData.config.dateFormat = document.getElementById('sDateFormat').value || 'DD/MM/YYYY';
  appData.config.timeFormat = document.getElementById('sTimeFormat').value || '24h';

  saveData();
  document.getElementById('shopName').textContent = appData.config.shopName;
  showToast(t('msg_saved'));
}

function saveStoreSettings() {
  appData.config.shopName = document.getElementById('sShopNameStore').value || 'Ù…ØªØ¬Ø±ÙŠ';
  appData.config.shopPhone = document.getElementById('sShopPhone').value || '';
  appData.config.shopAddress = document.getElementById('sShopAddress').value || '';

  saveData();
  document.getElementById('shopName').textContent = appData.config.shopName;
  showToast(t('msg_saved'));
}

function saveSettingsPrint() {
  appData.config.printSettings.paperSize = document.getElementById('sPaperSize').value;
  appData.config.printSettings.copies = parseInt(document.getElementById('sCopies').value) || 1;
  appData.config.printSettings.printLogo = document.getElementById('sPrintLogo').checked;
  appData.config.printSettings.printShopName = document.getElementById('sPrintShopName').checked;
  appData.config.printSettings.printPhone = document.getElementById('sPrintPhone').checked;
  appData.config.printSettings.printWelcome = document.getElementById('sPrintWelcome').checked;
  appData.config.printSettings.printBarcode = document.getElementById('sPrintBarcode').checked;
  appData.config.printSettings.printCustBarcode = document.getElementById('sPrintCustBarcode').checked;

  saveData();
  showToast(t('msg_saved'));
}

function manualBackup() {
  const backup = {
    version: '1.0.2',
    date: new Date().toISOString(),
    data: appData,
  };

  const dataStr = JSON.stringify(backup, null, 2);
  const dataBlob = new Blob([dataStr], { type: 'application/json' });
  const url = URL.createObjectURL(dataBlob);
  const link = document.createElement('a');
  link.href = url;
  link.download = `pos-backup-${Date.now()}.json`;
  link.click();
  URL.revokeObjectURL(url);

  showToast(t('msg_backup_done'));
}

function importBackup(input) {
  const file = input.files[0];
  if (!file) return;

  const reader = new FileReader();
  reader.onload = (e) => {
    try {
      const backup = JSON.parse(e.target.result);
      appData = backup.data;
      saveData();
      showToast(t('msg_saved'));
      location.reload();
    } catch (error) {
      showToast('Ø®Ø·Ø£ ÙÙŠ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù†Ø³Ø®Ø©');
    }
  };
  reader.readAsText(file);
}

function toggleAutoBackup(checked) {
  appData.config.autoBackup = checked;
  saveData();
  showToast(checked ? t('msg_backup_auto_on') : t('msg_backup_auto_off'));
}

function checkAutoBackup() {
  if (!appData.config.autoBackup) return;

  const lastBackup = localStorage.getItem('lastBackup');
  const today = new Date().toDateString();

  if (lastBackup !== today) {
    manualBackup();
    localStorage.setItem('lastBackup', today);
  }
}

function confirmPartialReset() {
  const input = prompt(t('msg_reset_confirm'));
  if (input !== 'Ù†Ø¹Ù…') {
    showToast(t('msg_reset_cancel'));
    return;
  }

  appData.sales = [];
  appData.debts = [];
  saveData();
  showToast(t('msg_reset_done'));
}

function confirmReset() {
  const input = prompt(t('msg_reset_confirm'));
  if (input !== 'Ù†Ø¹Ù…') {
    showToast(t('msg_reset_cancel'));
    return;
  }

  appData = {
    users: [{ name: 'Ù…Ø¯ÙŠØ±', pin: '0000', role: 'manager' }],
    families: [],
    brands: [],
    products: [],
    customers: [],
    sales: [],
    debts: [],
    config: appData.config,
  };

  saveData();
  logout();
  showToast(t('msg_reset_done'));
}

/* ================================================
   UTILITIES â€” Ø§Ù„Ø£Ø¯ÙˆØ§Øª
================================================ */
function show(page) {
  document.querySelectorAll('[id*="Menu"]').forEach(menu => menu.classList.add('hidden'));
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));

  if (page === 'sale') {
    document.getElementById('sale').classList.add('active');
    loadCustomerSelect();
  } else if (page === 'stock') {
    document.getElementById('stock').classList.add('active');
    showStockTab('families');
  } else if (page === 'suppliers') {
    // Supplier management logic here
  } else if (page === 'customers') {
    document.getElementById('customers').classList.add('active');
    loadCustomers();
  } else if (page === 'alerts') {
    openUsersModal();
  } else if (page === 'reports') {
    document.getElementById('reports').classList.add('active');
    loadReports();
    loadDebts();
  } else if (page === 'settings') {
    document.getElementById('settings').classList.add('active');
    loadSettings();
  }

  document.getElementById('menuBtn').click();
}

function loadSettings() {
  document.getElementById('sShopName').value = appData.config.shopName || '';
  document.getElementById('sShopNameStore').value = appData.config.shopName || '';
  document.getElementById('sShopPhone').value = appData.config.shopPhone || '';
  document.getElementById('sShopAddress').value = appData.config.shopAddress || '';
  document.getElementById('sCurrency').value = appData.config.currency || 'Ø¯Ø¬';
  document.getElementById('sLang').value = appData.config.lang || 'ar';
  document.getElementById('sDateFormat').value = appData.config.dateFormat || 'DD/MM/YYYY';
  document.getElementById('sTimeFormat').value = appData.config.timeFormat || '24h';
  document.getElementById('sPaperSize').value = appData.config.printSettings.paperSize;
  document.getElementById('sCopies').value = appData.config.printSettings.copies;
  document.getElementById('sPrintLogo').checked = appData.config.printSettings.printLogo;
  document.getElementById('sPrintShopName').checked = appData.config.printSettings.printShopName;
  document.getElementById('sPrintPhone').checked = appData.config.printSettings.printPhone;
  document.getElementById('sPrintWelcome').checked = appData.config.printSettings.printWelcome;
  document.getElementById('sPrintBarcode').checked = appData.config.printSettings.printBarcode;
  document.getElementById('sPrintCustBarcode').checked = appData.config.printSettings.printCustBarcode;
  document.getElementById('sAutoBackup').checked = appData.config.autoBackup;
}

function updateClock() {
  const now = new Date();
  const dateStr = now.toLocaleDateString('ar-DZ');
  const timeStr = now.toLocaleTimeString('ar-DZ', { hour: '2-digit', minute: '2-digit', second: '2-digit' });

  const dateEl = document.getElementById('currentDate');
  const timeEl = document.getElementById('currentTime');

  if (dateEl) dateEl.textContent = dateStr;
  if (timeEl) timeEl.textContent = timeStr;
}

function printInvoice(sale) {
  let html = `
    <div style="text-align:center;font-size:12px;font-family:monospace;max-width:350px">
      <div style="margin:10px 0;font-weight:bold;font-size:16px">ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</div>
      <div style="border-bottom:1px solid #000;margin:5px 0;padding:5px 0">
        ${appData.config.shopName}<br>
        ${appData.config.shopPhone}<br>
        ${new Date().toLocaleDateString('ar-DZ')} ${new Date().toLocaleTimeString('ar-DZ')}
      </div>
  `;

  sale.items.forEach(item => {
    const itemTotal = (item.price * item.qty).toFixed(2);
    html += `
      <div style="margin:5px 0">
        ${item.name} (${item.brand})<br>
        x${item.qty} Ã— ${item.price} = ${itemTotal}
      </div>
    `;
  });

  html += `
    <div style="border-top:1px solid #000;margin:10px 0;padding:5px 0;font-weight:bold">
      Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: ${sale.total.toFixed(2)} ${appData.config.currency}
    </div>
    <div style="margin:10px 0">Ø´ÙƒØ±Ø§Ù‹ Ù„ØªØ¹Ø§Ù…Ù„ÙƒÙ… Ù…Ø¹Ù†Ø§</div>
  `;

  const printWindow = window.open('', '', 'width=400,height=600');
  printWindow.document.write(html);
  printWindow.document.close();
  printWindow.print();
}

function togglePinVisibility() {
  const pinInput = document.getElementById('pin');
  const eyeIcon = document.getElementById('eyeIcon');

  if (pinInput.type === 'password') {
    pinInput.type = 'text';
    eyeIcon.style.opacity = '1';
  } else {
    pinInput.type = 'password';
    eyeIcon.style.opacity = '0.5';
  }
}

function showToast(message) {
  const toast = document.getElementById('globalToast');
  toast.textContent = message;
  toast.style.display = 'block';

  setTimeout(() => {
    toast.style.display = 'none';
  }, 3000);
}

function t(key) {
  const lang = appData.config.lang || 'ar';
  const strings = TRANSLATIONS[lang];
  return strings && strings[key] ? strings[key] : TRANSLATIONS.ar[key] || key;
}

/* ================================================
   DATA PERSISTENCE â€” Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
================================================ */
function saveData() {
  localStorage.setItem('posData', JSON.stringify(appData));
}

function loadData() {
  const saved = localStorage.getItem('posData');
  if (saved) {
    try {
      appData = JSON.parse(saved);
    } catch (e) {
      console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', e);
    }
  }
  initializeDefaultUser();
  loadUserSelect();
}

function emergencyReset() {
  if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ØŸ')) {
    localStorage.removeItem('posData');
    location.reload();
  }
}

/* ================================================
   INITIALIZE â€” Ø¨Ø¯Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
================================================ */
document.addEventListener('DOMContentLoaded', initApp);
